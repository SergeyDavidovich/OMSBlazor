@using OMSBlazor.Blazor.Components
@using OMSBlazor.Dto.Customer
@using OMSBlazor.Dto.Employee
@using ReactiveUI.Blazor
@inherits ReactiveComponentBase<CreateViewModel>

<MudGrid>
    <MudItem xs="12" lg="6" md="6" Class="d-flex align-stretch">
        <StupeniCard Title="Products on Store" Icon="@Icons.Material.Filled.Home" ButtonColor="MudBlazor.Color.Secondary" ButtonText="Remove all">
            <MudDataGrid Items="@ViewModel!.ProductsInStore" Virtualize="true" FixedHeader="true" Height="600px">
                <Columns>
                    <TemplateColumn Title="Added" IsEditable="true">
                        <CellTemplate>
                            <MudCheckBox @bind-Value="context.Item.Added"/>
                        </CellTemplate>
                    </TemplateColumn>
                    <PropertyColumn Title="Id" Property="x=>x.ProductID" />
                    <PropertyColumn Title="Product name" Property="x => x.ProductName" />
                    <PropertyColumn Title="Unit price" Property="x => x.UnitPrice" />
                    <PropertyColumn Title="Unit in stock" Property="x=>x.UnitsInStock" />
                    <PropertyColumn Title="Unit on order" Property="x=>x.UnitsOnOrder" />
                </Columns>
            </MudDataGrid>
        </StupeniCard>
    </MudItem>
    <MudItem xs="12" lg="6" md="6" Class="d-flex align-stretch">
        <StupeniCard Title="Products in Order" Icon="@Icons.Material.Filled.Timer" ButtonColor="MudBlazor.Color.Success" ButtonText="Create" IsButtonDisabled="true">
            <MudGrid>
                <MudItem xs="12">
                    <MudDatePicker Label="Order date" ReadOnly="true" DisableToolbar="true" />
                </MudItem>
                <MudItem xs="6">
                    <MudSelect T="EmployeeDto" ToStringFunc="GetFullName" Label="Employee" AnchorOrigin="Origin.BottomCenter">
                        @foreach (var employee in ViewModel!.Employees)
                        {
                            <MudSelectItem Value="employee"/>
                        }
                    </MudSelect>
                </MudItem>
                <MudItem xs="6">
                    <MudSelect T="CustomerDto" ToStringFunc="GetCustomerName" Label="Customer" AnchorOrigin="Origin.BottomCenter">
                        @foreach (var customer in ViewModel!.Customers)
                        {
                            <MudSelectItem Value="customer"/>
                        }
                    </MudSelect>
                </MudItem>
                <MudItem xs="12">
                    <MudDataGrid Items="@ViewModel!.ProductsInOrder">
                        <Columns>
                            <PropertyColumn Title="Id" Property="x => x.ProductID" />
                            <PropertyColumn Title="Product name" Property="x => x.ProductName" />
                            <PropertyColumn Title="Unit price" Property="x=>x.UnitPrice"/>
                            <PropertyColumn Title="Quantity" Property="x=>x.SelectedQuantity"/>
                            <PropertyColumn Title="Discount" Property="x=>x.SelectedDiscount"/>
                        </Columns>
                    </MudDataGrid>
                </MudItem>
                <MudItem xs="12">
                    <MudTextField T="string" Value="@($"Total price: {ViewModel!.TotalSumString}")" Variant="Variant.Text" Disabled="true"/>
                </MudItem>
            </MudGrid>
        </StupeniCard>
    </MudItem>
</MudGrid>

@code {
    private Func<EmployeeDto, string> GetFullName = employee => $"{employee.FirstName} {employee.LastName}";
    private Func<CustomerDto, string> GetCustomerName = customer => $"{customer.CompanyName}";
}
